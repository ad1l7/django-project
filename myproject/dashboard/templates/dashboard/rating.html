{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–†–µ–π—Ç–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="{% static 'dashboard/css/header.css' %}">
</head>
<body>
  {% include 'includes/header.html' %}

  <div class="container mt-5">
    <h2 class="mb-4">üèÜ –†–µ–π—Ç–∏–Ω–≥ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π</h2>

    <!-- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è -->
    <form method="get" class="mb-3">
        {% csrf_token %}
      <div class="btn-group" role="group">
        <a href="?filter=day" class="btn btn-outline-primary {% if filter == 'day' %}active{% endif %}">–ó–∞ –¥–µ–Ω—å</a>
        <a href="?filter=week" class="btn btn-outline-primary {% if filter == 'week' %}active{% endif %}">–ó–∞ –Ω–µ–¥–µ–ª—é</a>
        <a href="?filter=month" class="btn btn-outline-primary {% if filter == 'month' %}active{% endif %}">–ó–∞ –º–µ—Å—è—Ü</a>
      </div>
    </form>
  <div class="mt-4">
{% if request.user.role == 'ADMIN' or request.user.role == 'DIRECTOR' %}
  <div class="mt-4">
    <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#confirmResetModal">
      –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –Ω–∞–≥—Ä–∞–¥—ã
    </button>

  </div>
  {% endif %}
  </div>
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>–ú–µ—Å—Ç–æ</th>
          <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
          <th>–ù–∞–≥—Ä–∞–¥–∞</th>
        </tr>
      </thead>
      <tbody>
        {% for item in user_rewards %}
          <tr class="{% if forloop.counter == 1 %}table-warning fw-bold{% elif forloop.counter == 2 %}table-secondary fw-bold{% elif forloop.counter == 3 %}table-info fw-bold{% endif %}">
            <td>{{ forloop.counter }}</td>
            <td>{{ item.user.get_full_name }} ({{ item.user.username }}) ‚Äî <span class="text-muted">{{ item.role_label }}</span></td>

            <td>{{ item.reward }}</td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="3" class="text-center text-muted">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
{% if request.user.role == 'ADMIN' or request.user.role == 'DIRECTOR' %}



  <div class="modal fade" id="confirmResetModal" tabindex="-1" aria-labelledby="confirmResetLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <form method="post" action="{% url 'dashboard:reset_rewards' %}">
          {% csrf_token %}
          <div class="modal-header">
            <h5 class="modal-title" id="confirmResetLabel">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å"></button>
          </div>
          <div class="modal-body">
            –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ–±–Ω—É–ª–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—ã <strong>—É –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</strong>?
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
            <button type="submit" class="btn btn-danger">–û—á–∏—Å—Ç–∏—Ç—å</button>
          </div>
        </form>
      </div>
    </div>
  </div>
{% endif %}
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
